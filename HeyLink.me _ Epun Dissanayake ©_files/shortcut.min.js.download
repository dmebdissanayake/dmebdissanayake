var fbAppId=266003681172790;$(document).ready(function(){$(window).scroll(function(){if($(window).scrollTop()>150){$('.shortcut__component').removeClass('hidden');$('.shortcut__component').addClass('active');}
else{$('.shortcut__component').addClass('hidden');$('.shortcut__component').removeClass('active');}});function shortcutDropdownOpen(dropdownId){$(dropdownId).toggleClass('active');$('.popup-window').slideDown(800);}
$('#messageIcon').click(function(e){shortcutDropdownOpen('#dropdownMessage');});$('#subscribeIcon').click(function(e){shortcutDropdownOpen('#dropdownSubscribe');});$('#shareIcon').click(function(e){shortcutDropdownOpen('#dropdownShare');});$('.share-item[data-type="qr"]').click(function(e){shortcutDropdownOpen('#dropdownQR');$('#dropdownShare').removeClass('active');})
$('.btn-close-shortcut-popup').click(function(){$('.dropdown-popup').removeClass('active');$('.popup-window').slideUp(800);});let tab=$('.subscribe-tabs .tabs-items > div');tab.hide().filter(':first').show();$('.subscribe-tabs .tabs-nav a').click(function(){tab.hide();tab.filter(this.hash).show();$('.subscribe-tabs .tabs-nav a').removeClass('active');$(this).addClass('active');return false;}).filter(':first').click();function socialMediaShare(type,url){var target='_blank';var iframeParams='menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=300,width=600';switch(type){case'fb':var baseFbUrl='https://www.facebook.com/sharer/sharer.php?app_id=';window.open(baseFbUrl+fbAppId+'&u='+encodeURI(url)+'&href='+encodeURI(url)+'&t='+encodeURI(document.title),target,iframeParams);break;case'tw':var baseTwUrl='https://twitter.com/share?url=';window.open(baseTwUrl+encodeURI(url)+'&text='+encodeURI(document.title),target,iframeParams);break;case'telegram':var baseTgUrl='https://t.me/share/url?url=';window.open(baseTgUrl+encodeURI(url)+'&text='+encodeURI(document.title),target,iframeParams);break;case'linkedin':var baseLdUrl='https://www.linkedin.com/shareArticle?mini=true&url=';window.open(baseLdUrl+encodeURI(url)+'&title='+encodeURI(document.title)+'&source='+'',target,iframeParams);break;return null;}}
$('.share-item').click(function(){let dataType=$(this).data('type');let shareurl=$('.share-item').data('shareurl');socialMediaShare(dataType,shareurl);return false;});$('.share-item[data-type="email"]').click(function(){let shareurl=$('.share-item').data('shareurl');let mailto=`mailto: ?subject=HeyLink.me&body=${shareurl}`;window.location.href=mailto;})
$('.btn-png').click(function(){let downloadImage=$(this).data('image');let downloadImageReady;fetch(downloadImage).then(res=>res.blob()).then(blob=>(downloadImageReady=blob)).then(()=>{download(downloadImageReady,'qrcode-heylinkme-profile',downloadImageReady.type);})});const requiredValidationError=$('#i18n-validation-required').text();const errorElement=$('.validation-error-shortcut');$('form[data-action="ShortcutSubscribeGenerator"]').each(function(index){let subscriptionForm=$(this);let id=$(this).data('id');subscriptionForm.validate({errorElement:'div',errorClass:'validation-error-shortcut',rules:{value:{required:true,}},messages:{value:{required:requiredValidationError,},},submitHandler:function(form,params){const subscriptionType=subscriptionForm.find('input').data('type');const subscriptionInput=subscriptionForm.find('input').val();const ownerUsername=subscriptionForm.data('username');const formId=subscriptionForm.data('id');const errorElement=subscriptionForm.find('.validation-error-shortcut[data-id='+id+']');const successMessage=subscriptionForm.data('success-message');$.ajax({type:form.method,dataType:'json',contentType:'application/json',url:form.action,data:JSON.stringify({"value":subscriptionInput,"signup_type":subscriptionType,"username":ownerUsername,}),success:function(data){if(data.status==="ok"){$('form[data-id='+formId+']').css({'display':'none'})
$('.result-message[data-id='+formId+']').css({'display':'block'});}},error:function(data){if(data.responseJSON){errorElement.fadeIn().text(data.responseJSON.error);}}});}});});const phoneValidationError=$('#i18n-validation-phone').text();const emailValidationError=$('#i18n-validation-email').text();const tooLongValidationError=$('#i18n-validation-too-long').text();if($('form#anonymousMessageShortcutForm').length){let isNameRequired=false;let isEmailRequired=false;let isEmailValid=false;let isPhoneRequired=false;let isCustomField1Required=false;let isCustomField2Required=false;let isCustomField3Required=false;$.validator.addMethod('phone_number',function(value,element){return this.optional(element)||/^\+?\d{1,4}?[-.\s]?\(?\d{1,3}?\)?[-.\s]?\d{1,4}[-.\s]?\d{1,4}[-.\s]?\d{1,9}$/.test(value);},phoneValidationError);if($("#shortcutAnonymousMessagesNameInput").length&&$("#shortcutAnonymousMessagesNameInput").data('required').toLowerCase()==='true'){isNameRequired=true;}
if($("#shortcutAnonymousMessagesEmailInput").length&&$("#shortcutAnonymousMessagesEmailInput").data('required').toLowerCase()==='true'){isEmailRequired=true;}
if($("#shortcutAnonymousMessagesPhoneInput").length&&$("#shortcutAnonymousMessagesPhoneInput").data('required').toLowerCase()==='true'){isPhoneRequired=true;}
if($("#shortcutAnonymousMessagesCustomField1Input").length&&$("#shortcutAnonymousMessagesCustomField1Input").data('required').toLowerCase()==='true'){isCustomField1Required=true;}
if($("#shortcutAnonymousMessagesCustomField2Input").length&&$("#shortcutAnonymousMessagesCustomField2Input").data('required').toLowerCase()==='true'){isCustomField2Required=true;}
if($("#shortcutAnonymousMessagesCustomField3Input").length&&$("#shortcutAnonymousMessagesCustomField3Input").data('required').toLowerCase()==='true'){isCustomField3Required=true;}
if($("#shortcutAnonymousMessagesEmailInput").length){$('#shortcutAnonymousMessagesEmailInput').on('keyup paste',function(e){let input=$(this).val();if(input.length>0){$("#shortcutAnonymousMessagesEmailInput").rules("add",{email:true,});}});}
$('form#anonymousMessageShortcutForm').validate({errorElement:'div',errorClass:'validation-error',rules:{message:{required:true,maxlength:512,},name:{required:isNameRequired,maxlength:255,},email:{required:isEmailRequired,email:true,maxlength:254,},phone:{phone_number:true,minlength:10,maxlength:16,required:isPhoneRequired,},custom_field1:{required:isCustomField1Required,maxlength:225,},custom_field2:{required:isCustomField2Required,maxlength:225,},custom_field3:{required:isCustomField3Required,maxlength:225,},},messages:{email:{email:emailValidationError,required:requiredValidationError,maxlength:tooLongValidationError,},name:{required:requiredValidationError,maxlength:tooLongValidationError,},message:{required:requiredValidationError,maxlength:tooLongValidationError,},phone:{phone_number:phoneValidationError,required:requiredValidationError,maxlength:tooLongValidationError,},custom_field1:{required:requiredValidationError,maxlength:tooLongValidationError,},custom_field2:{required:requiredValidationError,maxlength:tooLongValidationError,},custom_field3:{required:requiredValidationError,maxlength:tooLongValidationError,},},submitHandler:function(form,params){const messageForm=form;const message=$('#shortcutAnonymousMessageTextArea').val();const username=$(messageForm).data('username');let nameField=null;let emailField=null;let phoneField=null;let customField1=null;let customField2=null;let customField3=null;if($("#shortcutAnonymousMessagesNameInput").length){nameField=$("#shortcutAnonymousMessagesNameInput").val();}
if($("#shortcutAnonymousMessagesEmailInput").length){emailField=$("#shortcutAnonymousMessagesEmailInput").val();}
if($("#shortcutAnonymousMessagesPhoneInput").length){phoneField=$("#shortcutAnonymousMessagesPhoneInput").val();}
if($("#shortcutAnonymousMessagesCustomField1Input").length){customField1=$("#shortcutAnonymousMessagesCustomField1Input").val();}
if($("#shortcutAnonymousMessagesCustomField2Input").length){customField2=$("#shortcutAnonymousMessagesCustomField2Input").val();}
if($("#shortcutAnonymousMessagesCustomField3Input").length){customField3=$("#shortcutAnonymousMessagesCustomField3Input").val();}
$.ajax({type:form.method,dataType:'json',contentType:'application/json',url:form.action,data:JSON.stringify({"message":message,"username":username,"name":nameField,"email":emailField,"phone":phoneField,"custom_field1":customField1,"custom_field2":customField2,"custom_field3":customField3}),success:function(data){if(data.status==="ok"){$('#anonymousMessageShortcutForm').css({'display':'none'})
$('.shortcut-anonymous-msg-success-message').css({'display':'block'})}},error:function(data){if(data.responseJSON){var key=Object.keys(data.responseJSON)[0];if(key==='message'){var errorElement=$('#anonymousMessageShortcutForm #shortcutAnonymousMessagesTextInput-error');}else if(key==='email'){var errorElement=$('#anonymousMessageShortcutForm #shortcutAnonymousMessagesEmailInput-error');}else if(key==='phone'){var errorElement=$('#anonymousMessageShortcutForm #shortcutAnonymousMessagesPhoneInput-error');}else if(key==='custom_field1'){var errorElement=$('#anonymousMessageShortcutForm #shortcutAnonymousMessagesCustomField1Input-error');}else if(key==='custom_field2'){var errorElement=$('#anonymousMessageShortcutForm #shortcutAnonymousMessagesCustomField2Input-error');}else if(key==='custom_field3'){var errorElement=$('#anonymousMessageShortcutForm #shortcutAnonymousMessagesCustomField3Input-error');}
errorElement.fadeIn().text(data.responseJSON[key]);}}});}});}
$('#shortcutAnonymousMessageTextArea').on('keyup paste',function(e){let input=$(this).val(),inputLength=input.length,maxCharacters=512,remain=parseInt(maxCharacters-inputLength);$('#shortcutAnonymousMessagesTextInputMaxCharacters i').text(remain);if(remain<=0&&e.which!==0&&e.charCode!==0){$('#shortcutAnonymousMessageTextArea').val((input).substring(0,inputLength-1))}});});